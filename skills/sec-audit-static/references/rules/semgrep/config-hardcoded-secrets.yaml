rules:
  - id: yaml-hardcoded-secret
    languages: [yaml]
    message: "Hardcoded secret-like value in configuration. Move to secret manager or env vars."
    severity: ERROR
    patterns:
      - pattern-either:
          - pattern: "default-secret: $VAL"
          - pattern: "aws-access-key-id: $VAL"
          - pattern: "aws-secret-access-key: $VAL"
          - pattern: "secret: $VAL"
    metadata:
      cwe: "CWE-798"
      owasp: "A07:2021 Identification and Authentication Failures"
      category: "Credential Exposure"
      likelihood: "high"
      confidence: "medium"
